"use strict";class AddAlarmView{constructor(){this.container=document.querySelector(".add-alarm-view"),this.name=this.container.querySelector(".name"),this.time=this.container.querySelector(".time"),this.days=this.container.querySelectorAll("input[type=checkbox]"),this.add_button=this.container.querySelector(".add"),this.add_button.addEventListener("click",(()=>{this.hide(),this.getValues(),this.resetValues()})),this.delete_button=this.container.querySelector(".delete"),this.delete_button.addEventListener("click",(()=>{this.hide(),this.parent_alarm.createAlarm(),this.resetValues()})),this.cancel_button=this.container.querySelector(".cancel"),this.cancel_button.addEventListener("click",(()=>{this.hide(),this.resetValues()}))}show(e,t,a){this.parent_alarm=t,this.container.classList.remove("hidden"),"edit"===e?(this.container.classList.remove("add"),this.container.classList.add("edit"),this.setValues(a)):(this.container.classList.remove("edit"),this.container.classList.add("add"))}hide(){this.container.classList.add("hidden")}resetValues(){this.name.value="",this.time.value="",this.days.forEach((e=>e.checked=!1))}getValues(){const e={name:this.name.value.trim(),time:this.time.value,days:[]};""==e.name&&(e.name="Alarm"),""==e.time&&(e.time="00:00"),this.days.forEach((t=>e.days.push(t.checked))),this.parent_alarm.createAlarm(e)}setValues(e){this.name.value=e.name,this.time.value=e.time,this.days.forEach(((t,a)=>t.checked=e.days[a]))}}class Alarm{constructor(e,t){this.container=e,this.is_active=!1,this.interval=null,this.container.addEventListener("click",(e=>{e.target.classList.contains("add")&&add_alarm_view.show("add",this)})),this.createAlarm(t)}createAlarm(e){if(this.container.innerHTML="",null==e)return void this.container.classList.add("add");this.is_active=!0,this.interval=setInterval((()=>{const t=new Date(Date.now()),a=(t.getDay()+6)%7,i=t.getHours(),s=t.getMinutes();console.log(this.is_active,e.days[a],`${i}:${s}`,e.time),this.is_active&&`${i}:${s}`==e.time&&(e.days[a]?new Audio("./alarm.mp3").play():e.days.includes(!0)||(new Audio("./Alarms/alarm.mp3").play(),setTimeout((()=>{this.is_active=!1,this.container.classList.add("unactive")}),1e3)),this.interval=clearInterval(this.interval))}),1e3);const t=["Mon.","Tue.","Wed.","Thu.","Fri.","Sat.","Sun."];let a="";e.days.includes(!0)||(a="One time");for(let i=0;i<7;i++)e.days[i]&&(a+=t[i]+" ");const i=createNewDOM("div","col"),s=createNewDOM("div","row"),n=createNewDOM("div","name",e.name),r=createNewDOM("div","time",e.time);s.appendChild(n),s.appendChild(r),i.appendChild(s);const l=createNewDOM("div","days",a);i.appendChild(l),this.container.appendChild(i);const c=createNewDOM("div","col"),d=createNewDOM("div","switch"),h=createNewDOM("button","edit","Edit");c.appendChild(d),c.appendChild(h),this.container.appendChild(c),h.addEventListener("click",(()=>add_alarm_view.show("edit",this,e))),d.addEventListener("click",(()=>{this.is_active=!this.is_active,this.container.classList.toggle("unactive")})),this.container.classList.remove("add")}}class AlarmView{constructor(){this.container=document.querySelector(".alarm-view"),null==localStorage.getItem("alarms")&&localStorage.setItem("alarms","[]"),this.alarms_data=JSON.parse(localStorage.getItem("alarms")),this.alarms_containers=this.container.querySelectorAll(".alarm"),this.alarms=[];for(let e=0;e<8;e++)null==this.alarms_data[e]?this.alarms.push(new Alarm(this.alarms_containers[e])):this.alarms.push(new Alarm(this.alarms_containers[e],this.alarms_data[e]))}}const add_alarm_view=new AddAlarmView;new AlarmView;